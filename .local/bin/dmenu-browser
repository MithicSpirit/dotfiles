#!/usr/bin/env zsh

_copy() { echo -n "$@" | xclip -in -selection clipboard }

typeset -A options_=(
	['0.  New window']="$REAL_BROWSER --new-window"
	['1.  Current window']="$REAL_BROWSER"
	['2.  Copy to clipboard']="_copy"
	['3.  mpv']="mpv"
	['4.  Qutebrowser']="qutebrowser"
	['5.  Tor Browser']="torbrowser-launcher"
	['6.  Chromium']="chromium"
	['7.  Firefox']="firefox"
	['8.  Brave']="brave-nightly"
	['9.  Librewolf']="librewolf"
	['10. Nyxt']="nyxt"
	['11. IceCat']="icecat"
	['12. Vieb']="vieb"
)

prompt="Browser"
entries="${(@kF)options_}"
num="${#options_}"

sel="$(sort -n <<<"$entries" | dmenu -bw 3 -c -R -l "$num" -p "$prompt")"

[[ -n "$sel" ]] && {
	result="${options_[$sel]}"
	echo "\n-- $(date) --\n-> \$ $0 $@\n<- \$ $result $@" >>/tmp/dmenu-browser.log
	echo "$result $@"
	eval "$result" "$@" &>>/tmp/dmenu-browser.log &!
}
