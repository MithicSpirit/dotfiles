#!/usr/bin/env zsh

_copy() { echo -n "$1" | xclip -in -selection clipboard }

typeset -A options_=(
	['0.  New window']="$REAL_BROWSER --new-window"
	['1.  Current window']="$REAL_BROWSER"
	['2.  Copy to clipboard']="_copy"
	['3.  Qutebrowser']="qutebrowser"
	['4.  Tor Browser']="torbrowser-launcher"
	['5.  Chromium']="chromium"
	['6.  Firefox']="firefox"
	['7.  Brave']="brave-nightly"
	['8.  Librewolf']="librewolf"
	['9.  Nyxt']="nyxt"
	['10. IceCat']="icecat"
	['11. Vieb']="vieb"
)

prompt="Browser"
entries="${(@kF)options_}"
num="${#options_}"

sel="$(sort -n <<<"$entries" | dmenu -bw 3 -c -R -l "$num" -p "$prompt")"

[[ -n "$sel" ]] && {
	result="${options_[$sel]}" 
	printf "\n-- %s --\n-> $ %s %s\n<- $ %s %s\n" "$(date)" \
		"$0" "$@" "$result" "$1" >>/tmp/dmenu-browser.log
	eval "$result '$1'" &>>/tmp/dmenu-browser.log &!
}
