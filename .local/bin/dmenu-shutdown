#!/usr/bin/env zsh

LOCK_SCREEN="xautolock -locknow"
typeset -A options_=(
	['0. Lock']="$LOCK_SCREEN"
	['1. Log off']="systemctl --user exit; killall qtile"
	['2. Shut down']="systemctl poweroff"
	['3. Restart']="systemctl reboot"
	['4. Suspend']="$LOCK_SCREEN & systemctl suspend; wait"
)

prompt="Power"
entries="${(@kF)options_}"
num="${#options_}"

sel="$(sort -n <<<"$entries" | dmenu -bw 3 -c -R -l "$num" -p "$prompt")"

[[ -n "$sel" ]] && {
	printf "\n-- %s --\n" "$(date)" >>/tmp/power.log
	eval "${options_[$sel]} $1" &>>/tmp/power.log &!
}
